{% extends "lampstands/base_blog.html" %}
{% load staticfiles lampstands_tags wagtailcore_tags wagtailimages_tags %}
{% block title %}
{% if self.seo_title %}{{ self.seo_title }}{% else %}{{ self.title }}{% endif %} | The Local Churches
{% endblock %}

{% block extra_links %} 
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.14/css/jquery.dataTables.min.css" >
{% endblock %}

{% block content %}
    
    <div class="content-title">
            <div class="content-title-inner">
                <div class="vessel">
                    <a href="https://safe-cove-64619.herokuapp.com/churches">  
                    <h1>Localities</h1> 
                    </a>              
                </div><!-- /.vessel -->
            </div><!-- /.content-title-inner -->
    </div><!-- /.content-title -->                          

    <div class="content">
        <div class="vessel">
            <div class="posts posts-grid">  
                <div class="row">
                <br>
                <br>  

        <table class="table order-column stripe hover display" id="churches-table" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Index</th>
                    <th>City</th>
                    <th>Address</th>
                    <th>State/Prov.</th>
                    <th>Country</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Website</th>
                </tr>
            </thead>

            <tbody>
                {% for branch in church_posts %} 
                    <tr>
                        <td></td>
                        <td>{{branch.locality_name}}</td>
                        <td>{{branch.meeting_address}}</td>
                        <td>{{branch.locality_state_or_province}}
                        <td>{{branch.locality_country}}</td>
                        <td>{{branch.locality_phone_number}}</td>
                        <td>{{branch.locality_email}}</td>
                        <td>{{branch.locality_web}}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
  
                </div><!-- /.row -->
            </div><!-- /.posts-->
        </div><!-- /.vessel -->
    </div><!-- /.content -->

    <div class="content">
        <div class="vessel">
            <div class="posts posts-grid">  
                <div class="row">
                <br>
                <br>  

        <table class="table order-column stripe hover display" id="churches-mobile" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Index</th>
                    <th>City</th>
                    <th>Address</th>
                    <th>State/Prov.</th>
                    <th>Country</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Website</th>
                </tr>
            </thead>

            <tbody>
                {% for branch in church_posts %} 
                    <tr>
                        <td></td>
                        <td>{{branch.locality_name}}</td>
                        <td>{{branch.meeting_address}}</td>
                        <td>{{branch.locality_state_or_province}}
                        <td>{{branch.locality_country}}</td>
                        <td>{{branch.locality_phone_number}}</td>
                        <td>{{branch.locality_email}}</td>
                        <td>{{branch.locality_web}}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
  
                </div><!-- /.row -->
            </div><!-- /.posts-->
        </div><!-- /.vessel -->
    </div><!-- /.content -->



{% endblock %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://cdn.datatables.net/1.10.14/js/jquery.dataTables.min.js"></script>    
    <script>    
    $(document).ready(function() {
    var t = $('#churches-table').DataTable( {
        "columnDefs": [ {
            "searchable": false,
            "orderable": false,
            "targets": 0
        } ],
        "order": [[ 1, 'asc' ]],
    } );
 
    t.on( 'order.dt search.dt', function () {
        t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
            cell.innerHTML = i+1;
        } );
    } ).draw();
} );
    </script>
    <script>
        /* Formatting function for row details - modify as you need */
    function format ( d ) {
        // `d` is the original data object for the row
        return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
            '<tr>'+
                '<td>Full name:</td>'+
                '<td>'+d.locality_name+'</td>'+
            '</tr>'+
            '<tr>'+
                '<td>Extension number:</td>'+
                '<td>'+d.locality_web+'</td>'+
            '</tr>'+
            '<tr>'+
                '<td>Extra info:</td>'+
                '<td>And any further details here (images etc)...</td>'+
            '</tr>'+
        '</table>';
    }
     
    $(document).ready(function() {
    var t = $('#churches-mobile').DataTable( {
        "columnDefs": [ {
            "searchable": false,
            "orderable": false,
            "targets": 0
        } ],
        "order": [[ 1, 'asc' ]],
    } );
 
    t.on( 'order.dt search.dt', function () {
        t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
            cell.innerHTML = i+1;
        } );
    } ).draw();
         
        // Add event listener for opening and closing details
        $('#churches-mobile tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = table.row( tr );
     
            if ( row.child.isShown() ) {
                // This row is already open - close it
                row.child.hide();
                tr.removeClass('shown');
            }
            else {
                // Open this row
                row.child( format(row.data()) ).show();
                tr.addClass('shown');
            }
        } );
    } );    
    </script>
{% endblock %}