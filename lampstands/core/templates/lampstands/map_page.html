{% load lampstands_tags cache staticfiles wagtailuserbar wagtailcore_tags wagtailimages_tags wagtailsettings_tags %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>{% block title_postfix %} Map| The Local Churches {% endblock %}</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.min.css' %}" >
    <link href="{% static 'lampstands/css/packages/src/style.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" id="css-primary" href="{% static 'css/villareal-turquoise.css' %}" >
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'css/img/LCblueicon.ico' %}" >
    <title>Local Churches</title>
</head>
<body>

<body class="content-title-center">
<div class="page-wrapper">
    
        <div class="header-wrapper">
    <div class="header header-small">
        <div class="header-inner">
            <div class="vessel">
                
                <div class="header-top header-background">
                    <div class="header-top-inner">
                        <a class="header-logo" href="/">  
                            <span class="header-logo-text">the local churches</span>
                        </a><!-- /.header-logo -->

<div class="nav-primary-wrapper collapse navbar-toggleable-sm">
    <ul class="nav nav-pills nav-primary bleed out-animation">
        <li class="nav-item nav-item-parent">
            <a href="https://safe-cove-64619.herokuapp.com/map" class="nav-link menu button">
                Find Us
            </a>
            <ul class="sub-menu">
                <li><a href="https://safe-cove-64619.herokuapp.com/churches">List of Churches</a></li>
            </ul>
        </li>

         <li class="nav-item">
            <a href="https://safe-cove-64619.herokuapp.com/testimonies" class="nav-link menu button">
                Testimonies
            </a>
        </li>       

        <li class="nav-item nav-item-parent">
            <a href="https://safe-cove-64619.herokuapp.com/beliefs" class="nav-link menu button">
                Beliefs
            </a>

            <ul class="sub-menu">
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/our-beliefs">Our Beliefs</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/our-standing">Our Standing</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/our-mission">Our Mission</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/our-hope">Our Hope</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/recovery">Concerning the Recovery</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/salvation">Concerning Salvation</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/christian-life">Concerning Christian Life</a></li>
                <li><a href="https://safe-cove-64619.herokuapp.com/beliefs/church-life">Concerning Church Life</a></li></ul>           
        </li>   
        

        <li class="nav-item">
            <a href="https://safe-cove-64619.herokuapp.com/recognition" class="nav-link menu button">
                Recognition
            </a>        
        </li>   

        <li class="nav-item nav-item ">
            <a href="https://safe-cove-64619.herokuapp.com/history" class="nav-link menu button">
                History
            </a>         
        </li>

                                      
    </ul><!-- /.nav -->
</div><!-- /.nav-primary -->


<div class="top-mobile-icon pull-xs-right hidden-md-up">
<a href="https://safe-cove-64619.herokuapp.com/faq"><i class="fa fa-question-circle"></i></a>
</div>
<div class="top-mobile-icon pull-xs-right hidden-md-up">
<a href="https://safe-cove-64619.herokuapp.com/contact"><i class="fa fa-envelope"></i></a>
</div>                                    
                         
                    </div><!-- /.header-top-inner -->
                </div><!-- /.header-top -->

            </div><!-- /.vessel -->

        </div><!-- /.header-inner -->
    </div><!-- /.header -->
</div><!-- /.header-wrapper-->
    

    <div class="main-wrapper">
            <div class="main-inner">      



<div class="map_wrapper">
<div class="map-toggle" style="background-color: #555; width: 100%;">


            <h6 style="font-weight: 500; color: white; text-align: center;">
                <button style="border-radius: 4px; background-color: darkgrey; padding: 0.5em 1.18em; margin: 0 0.7em;" onclick="location.href='https://safe-cove-64619.herokuapp.com/churches/'">Search by List</button>
                <button style="cursor: default; border-radius: 4px; background-color: #0BB7A5; border-color: transparent; padding: 0.5em 1em; margin: 0 0.7em; box-shadow: inset 0 0 10px #ccc;">Search by Map</button>
                
            </h6>

        <!--<button onclick="myFunction()">List it</button>-->

</div> <!--map-toggle-->

    <div id="map" class="map_container">
    </div>
    
    <div class="map_results">

        <div class="map_detail"></div>

        <div class="map_listings">
            <div class="map_listings_headline">
                <h2>Results<span class="map_listings_number"></span></h2>
            </div>
            <div class="map_listings_results">

            </div>
        </div>
    </div>
</div>

 </div><!-- /.main-inner -->
    </div><!-- /.main-wrapper -->

<div class="icon-bar navbar-fixed-bottom hidden-md-up">
    <a class="active" href="https://safe-cove-64619.herokuapp.com/churches"><i class="fa fa-search"></i>
        <p style="font-size: small; font-family: sans-serif;">Find Us</p>
    </a>
    <a href="https://safe-cove-64619.herokuapp.com/testimonies"><i class="fa fa-users"></i>
        <p style="font-size: small; font-family: sans-serif;">Testimonies</p>    
    </a>
    <a href="https://safe-cove-64619.herokuapp.com/beliefs"><i class="fa fa-book"></i>
        <p style="font-size: small; font-family: sans-serif;">Beliefs</p>
    </a>
    <a href="https://safe-cove-64619.herokuapp.com/recognition"><i class="fa fa-comments"></i>
        <p style="font-size: small; font-family: sans-serif;">Recognition</p>
    </a>
    <a href="https://safe-cove-64619.herokuapp.com/history"><i class="fa fa-history"></i>
    <p style="font-size: small; font-family: sans-serif;">History</p>
    </a>
</div>

    <div class="footer-wrapper hidden-md-down">
    <div class="vessel">
        <div class="footer-inner">
            

            <div class="footer-bottom">
                <div class="footer-left">
                    &copy; 2017 All Rights reserved.
                </div><!-- /.footer-left -->

                <div class="footer-right">
                    <ul class="nav nav-pills">
                        <li class="nav-item"><a href="https://safe-cove-64619.herokuapp.com/faq" class="nav-link">FAQ's</a></li>
                        <li class="nav-item"><a href="https://safe-cove-64619.herokuapp.com/privacy" class="nav-link">Privacy Policy</a></li>
                        <li class="nav-item"><a href="https://safe-cove-64619.herokuapp.com/contact" class="nav-link">Contact</a></li>
                    </ul>
                </div><!-- /.footer-right -->           
            </div><!-- /.footer-bottom -->
        </div><!-- /.footer-inner -->
    </div><!-- /.vessel -->
</div><!-- /.footer-wrapper -->
</div><!-- /.page-wrapper -->

<script type="text/javascript">
        function myFunction() {
    var x = document.getElementById('map');
    if (x.style.display === 'none') {
        x.style.display = 'block';
    } else {
        x.style.display = 'none';
    }
}     
    </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="{{self.google_url_js}}{{self.google_key_js}}&libraries=places,geometry"></script>
<script>
            var BUL = "{% static 'lampstands/css/packages/src/bullseye.png' %}"
            var BLA = "{% static 'lampstands/css/packages/pins/blank.png' %}"
            var STA = "{% static 'lampstands/css/packages/src/stars.png' %}"
</script>
<script src="{% static 'lampstands/css/packages/src/storeLocator.js' %}"></script>
<script src="{% static 'lampstands/css/packages/src/markerclusterer.js' %}"></script>
<script src="{% static 'lampstands/css/packages/src/jquery.tmpl.min.js' %}"></script>
<script>
    $(function() {
        $('.map_container').storeLocator({
            remote: "{{self.get_locality_json}}",
            defaultLocation:['{{geoinfo_lat}}','{{geoinfo_lng}}'],
            listOptions:{
                sortByDistance: true,
                distanceType: 'km',
            },
            detailsOptions: {
                panorama: {
                    showPanorama: false
                }
            },
            markerOptions: {
                dropAnimation: true
            },
            responsiveOptions: [
                {
                    breakpoint: 768,
                    settings: {
                        mapHeight: 1000,
                        listHeight: 1000,
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        mapHeight: 600,
                        listHeight: 600,
                    }
                }
            ],
            mapOptions: {
                mapTypeControl: false,
                zoom: {{zoom_deflevel}},
                zoomControlOptions: {
                        position: google.maps.ControlPosition.RIGHT_TOP
                    },
                minZoom: 1,
                maxZoom: 18
            },
            geoLocationOptions: {
                position: google.maps.ControlPosition.TOP_RIGHT,
                zoom: 10
            },
            autocompleteOptions: {
                zoom: 12,
                placeholder: 'Enter city name here',
                country: 'all',
                types: '(regions)',
                position: google.maps.ControlPosition.TOP_LEFT,
            },
            searchOptions: {
                show: true,
                placeholder:"Search within results below",
            },
            routeOptions: {
                show: true,
                closeHtml: '<span class="label label-danger">close</span>',
                country: null,
                placeholder: "Enter departure street name"
            },
            onUpdateList: function() {
                $('.stars').stars();
            },
            onUpdateDetail: function()
            {
                var current = 0,
                        items = $('.result_item_detail_info .slider_container div'),
                        itemsLength = items.length;

                items.hide();
                showItem();

                function showItem() {
                    var item = items.eq(current);
                    items.hide();
                    item.css('display', 'inline-block');
                }

                $(document).on('click', '.result_item_detail_info .slider_container .next',function () {
                    current += 1;
                    if (current > itemsLength - 1) {
                        current = 0;
                    }
                    showItem();
                });

                $(document).on('click', '.result_item_detail_info .slider_container .prev',function () {
                    console.log(itemsLength)
                    current -= 1;
                    if (current < 0) {
                        current = itemsLength - 1;
                    }
                    showItem();
                });


                if (window.timer) {
                    clearTimeout(timer);
                }
                timer = setTimeout(function () {
                    $('.result_item_detail .image').attr('src', 'https://www.w124-freunde.com/wcf/images/avatars/avatar-1868.gif');
                }, 3000);
            }
        });
    });
    /*
    http://stackoverflow.com/a/1987545
     */

    $.fn.stars = function() {
        return $(this).each(function() {
            $(this).html($('<span />').width(Math.max(0, (Math.min(5, Math.round(parseFloat($(this).html())) / 2))) * 16));
        });
    }
</script>
<script id="mapListEntryTemplate" type="text/x-jQuery-tmpl">
<div class="result_item" data-id="${id}">
    <a href= "https://safe-cove-64619.herokuapp.com${url}"><h3>${locality_name}</h3></a>
    <div class="result_item_info">
        <div class="info">
            <ul class="list-unstyled">
                <li><b>Address</b>: ${meeting_address}</li>
                <li><b>Phone</b>: ${locality_phone_number}</li>
                <li><b>E-Mail</b>: ${locality_email}</li>
                <li><b>Website</b>: <a href="${locality_web}">${locality_web}</a> </li>
            </ul>
            <a class="map_direction_trigger label label-danger">get route</a>
        </div>
    </div>
</div>
</script>
<script id="mapListDetailTemplate" type="text/x-jQuery-tmpl">
<div class="result_item_detail">
<a href="#" class="map_details_close"><img src="{% static 'lampstands/css/packages/src/close.png' %}" alt="Close"></a>
    <h3><a href="https://safe-cove-64619.herokuapp.com${url}">${locality_name}</a></h3>
    <div class="result_item_detail_info">
        <div class="info">
            <ul class="list-unstyled">
                <li><b>Address</b>: ${meeting_address}</li>
                <li><b>Phone</b>: ${locality_phone_number}</li>
                <li><b>E-Mail</b>: ${locality_email}</li>
                <li><b>Website</b>: <a href="${locality_web}">${locality_web}</a></li>
            </ul>
            <a class="map_direction_trigger label label-danger">get route</a>
        </div>
    </div>

    <!--
    <div class="result_item_detail_info">
        <h4>Tags</h4>
           ${tags}
    </div>
    <div class="result_item_detail_info">
    <h4>About</h4>
    ${about}
    </div>
    <div class="result_item_detail_info">
    <h4>Panorama View</h4>
        <div id="pano"> </div>
    </div>
    -->
</div>
</script>

</body>
</html>