<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
   	<meta name="viewport" content="width=device-width, initial-scale=1.0">
   	<meta name="description" content="">
   	<meta name="author" content="">
    <title>Title</title>

    <link href="src/style.css" rel="stylesheet">
    <link href="layout.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>
<div class="map_wrapper">
    <div id="map" class="map_container">
    </div>
    <div class="map_results">

        <div class="map_detail"></div>

        <div class="map_listings">
            <div class="map_listings_headline">
                <h2>Results <span class="map_listings_number"></span></h2>
            </div>
            <div class="map_listings_results">

            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA4MAVqADcBv3nSIqd8y7RZWF9kmcVB6XQ
&libraries=places,geometry"></script>
<!--<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>-->
<script src="src/storeLocator.min.js"></script>
<script src="src/markerclusterer.js"></script>
<script src="src/jquery.tmpl.min.js"></script>
<script>
    $(function() {
        $('.map_container').storeLocator({
            remote: 'src/stores.json',
            detailsOptions: {
                panorama: {
                    showPanorama: true
                }
            },
            responsiveOptions: [
                {
                    breakpoint: 768,
                    settings: {
                        mapHeight: 400,
                        listHeight: 400
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        mapHeight: 'full',
                        listHeight: 400
                    }
                }
            ],
            geoLocationOptions: {
                position: google.maps.ControlPosition.TOP_LEFT
            },
            routeOptions: {
                show: true,
                closeHtml: '<span class="label label-danger">close</span>',
            },
            onUpdateList: function() {
                $('.stars').stars();
            },
            onUpdateDetail: function()
            {
                var current = 0,
                        items = $('.result_item_detail_info .slider_container div'),
                        itemsLength = items.length;

                items.hide();
                showItem();

                function showItem() {
                    var item = items.eq(current);
                    items.hide();
                    item.css('display', 'inline-block');
                }

                $(document).on('click', '.result_item_detail_info .slider_container .next',function () {
                    current += 1;
                    if (current > itemsLength - 1) {
                        current = 0;
                    }
                    showItem();
                });

                $(document).on('click', '.result_item_detail_info .slider_container .prev',function () {
                    console.log(itemsLength)
                    current -= 1;
                    if (current < 0) {
                        current = itemsLength - 1;
                    }
                    showItem();
                });


                if (window.timer) {
                    clearTimeout(timer);
                }
                timer = setTimeout(function () {
                    $('.result_item_detail .image').attr('src', 'http://www.w124-freunde.com/wcf/images/avatars/avatar-1868.gif');
                }, 3000);
            }
        });
    });
    /*
    http://stackoverflow.com/a/1987545
     */

    $.fn.stars = function() {
        return $(this).each(function() {
            $(this).html($('<span />').width(Math.max(0, (Math.min(5, Math.round(parseFloat($(this).html())) / 2))) * 16));
        });
    }
</script>
</body>
</html>